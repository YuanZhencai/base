<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="/template/template.xhtml">

	<ui:define name="content">
		<p:layout fullPage="true">
			<p:layoutUnit position="west">
				<h:panelGroup>
					<h:form id="reportTreeForm" prependId="false">
						<p:tree value="#{reportQueryBean.root}" var="node" dynamic="true"
							cache="false" selectionMode="single"
							selection="#{reportQueryBean.selectedNode}" style="width:200px;">
							<p:ajax update="reportQueryPanel" event="select"
								listener="#{reportQueryBean.onNodeSelect}" />
							<p:treeNode>
								<h:outputText value="#{node}" />
							</p:treeNode>
						</p:tree>
					</h:form>
				</h:panelGroup>
			</p:layoutUnit>

			<p:layoutUnit position="center">
				<h:form id="reportQueryForm" prependId="false">
					<p:panel>
						<f:facet name="header">报表参数</f:facet>
						<h:panelGrid id="reportQueryPanel" columns="4">
							<ui:repeat var="reportParameter"
								value="#{reportQueryBean.reportParameterList}">
								
								#{reportParameter.uiLabel}:
								<ui:fragment
									rendered="#{reportQueryBean.uiTypeWenbk(reportParameter.uiType)}">
									<p:inputText
										value="#{reportQueryBean.reportMap[reportParameter.uiLabelLang]}" />
								</ui:fragment>
								<ui:fragment
									rendered="#{reportQueryBean.uiTypeCalendar(reportParameter.uiType)}">
									<p:calendar
										value="#{reportQueryBean.reportMap[reportParameter.uiLabelLang]}"
										pattern="yyyy-MM-dd">
										<f:convertDateTime pattern="yyyy-MM-dd" />
									</p:calendar>
								</ui:fragment>
							</ui:repeat>
							<p:commandButton id="btn_report_preview"
								action="#{reportQueryBean.preview}" value="预览"
								update="reportContent" image="ui-icon ui-icon-search" />
							&#160;&#160;
							<p:commandButton id="btn_report_export" action="#{reportQueryBean.exportReport}" value="导出" image="ui-icon ui-icon-disk" ajax="false"/>
						</h:panelGrid>
					</p:panel>
				</h:form>

				<h:form id="reportContentForm" prependId="false">
					<p:panel >
						<f:facet name="header">报表预览</f:facet>
						<h:panelGroup style="width:100%;text-align:center;"
							id="reportContent">
							<p:commandButton style="display:none" />
				    		#{reportQueryBean.reportContent}
						</h:panelGroup>
					</p:panel>
				</h:form>
			</p:layoutUnit>
		</p:layout>
	</ui:define>
</ui:composition>

